{
    "sql": "
  SELECT
    fullVisitorId,
    VisitId,
    date,
    IF(trafficSource.referralPath is NOT NULL, trafficsource.referralPath, '') AS referralPath,
    IF(trafficSource.keyword is NOT NULL, trafficsource.keyword, '') AS keyword,
    IF(trafficSource.medium is NOT NULL, trafficsource.medium, '') AS medium,
    IF(trafficSource.source is NOT NULL, trafficsource.source, '') AS source,
    IF(trafficSource.campaign is NOT NULL, trafficsource.campaign, '') AS campaign,
    IF(customdimensions.index=47, customdimensions.value, '') AS currentPath,
    IF(totals.visits is NOT NULL, totals.visits, 0) AS visits,
    IF(totals.hits is NOT NULL, totals.hits, 0) AS hits,
    IF(totals.pageviews is NOT NULL, totals.pageviews, 0) AS pageViews,
    IF(totals.bounces is NOT NULL, totals.bounces, 0) AS bounces,
    IF(totals.transactions is NOT NULL, totals.transactions, 0) AS transactions,
    IF(totals.newVisits is NOT NULL, totals.newVisits, 0) AS newVisits,
    IF(customDimensions.index=1, customDimensions.value, '') AS KfTier,
    IF(customDimensions.index=2, customDimensions.value, '') AS KfID,
    IF(customDimensions.index=3, customDimensions.value, '') AS KfNationality,
    IF(customDimensions.index=4, customDimensions.value, '') AS KfLastFlown,
    IF(customDimensions.index=7, customDimensions.value, '') AS FlightSearch,
    IF(customDimensions.index=9, customDimensions.value, '') AS CountrySelection,
    IF(customDimensions.index=10, customDimensions.value, '') AS LanguageSelection,
    IF(customDimensions.index=74, customDimensions.value, '') AS GaID,
    IF(customDimensions.index=75, customDimensions.value, '') AS DaysToDeparture,
    IF(customDimensions.index=81, customDimensions.value, '') AS FlightNumber,
    IF(customDimensions.index=28, customDimensions.value, '') AS ORIGIN,
    IF(customDimensions.index=29, customDimensions.value, '') AS DESTINATION,
    IF(customDimensions.index=36, customDimensions.value, '') AS DDAY,
    IF(customDimensions.index=37, customDimensions.value, '') AS DMONTH,
    IF(customDimensions.index=38, customDimensions.value, '') AS DYEAR,
    IF(customDimensions.index=39, customDimensions.value, '') AS RDAY,
    IF(customDimensions.index=40, customDimensions.value, '') AS RMONTH,
    IF(customDimensions.index=41, customDimensions.value, '') AS RYEAR,
    IF(customDimensions.index=19, customDimensions.value, '') AS TYPEOFTRIP,
    IF(customDimensions.index=31, customDimensions.value, '') AS CABIN,
    IF(customDimensions.index=42, customDimensions.value, '') AS NUMADULTS,
    IF(customDimensions.index=43, customDimensions.value, '') AS NUMCHILDREN,
    IF(customDimensions.index=44, customDimensions.value, '') AS NUMINFANTS,
  FROM
    TABLE_DATE_RANGE([46948678.ga_sessions_], DATE_ADD(CURRENT_TIMESTAMP(), -2, 'DAY'), CURRENT_TIMESTAMP())
  ",
    "legacy": true
}
